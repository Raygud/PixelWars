!function n(i,o,r){function a(t,e){if(!o[t]){if(!i[t]){var s="function"==typeof require&&require;if(!e&&s)return s(t,!0);if(c)return c(t,!0);throw(s=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",s}s=o[t]={exports:{}},i[t][0].call(s.exports,function(e){return a(i[t][1][e]||e)},s,s.exports,n,i,o,r)}return o[t].exports}for(var c="function"==typeof require&&require,e=0;e<r.length;e++)a(r[e]);return a}({1:[function(e,t,s){"use strict";var a=e("node-fetch"),c=e("./utils");t.exports=function(e,t){var s=void 0!==e.url?e.url:e.uri;if(c.isURL(s)||(s="https://api.twitch.tv/kraken"+("/"===s[0]?s:"/"+s)),c.isNode()){s=(o=c.merge({method:"GET",json:!0},e,{url:s})).url;o.qs&&(s+="?"+new URLSearchParams(o.qs));var n={};a(s,{method:o.method,headers:o.headers,body:o.body}).then(function(e){return n={statusCode:e.status,headers:e.headers},o.json?e.json():e.text()}).then(function(e){return t(null,n,e)},function(e){return t(e,n,null)})}else{var i,o=c.merge({method:"GET",headers:{}},e,{url:s}),r=new XMLHttpRequest;for(i in r.open(o.method,o.url,!0),o.headers)r.setRequestHeader(i,o.headers[i]);r.responseType="json",r.addEventListener("load",function(e){4==r.readyState&&(200!=r.status?t(r.status,null,null):t(null,null,r.response))}),r.send()}}},{"./utils":9,"node-fetch":10}],2:[function(c,u,e){(function(a){(function(){"use strict";function s(e){if(this instanceof s==!1)return new s(e);this.opts=H.get(e,{}),this.opts.channels=this.opts.channels||[],this.opts.connection=this.opts.connection||{},this.opts.identity=this.opts.identity||{},this.opts.options=this.opts.options||{},this.clientId=H.get(this.opts.options.clientId,null),this._globalDefaultChannel=H.channel(H.get(this.opts.options.globalDefaultChannel,"#tmijs")),this.maxReconnectAttempts=H.get(this.opts.connection.maxReconnectAttempts,1/0),this.maxReconnectInterval=H.get(this.opts.connection.maxReconnectInterval,3e4),this.reconnect=H.get(this.opts.connection.reconnect,!1),this.reconnectDecay=H.get(this.opts.connection.reconnectDecay,1.5),this.reconnectInterval=H.get(this.opts.connection.reconnectInterval,1e3),this.reconnecting=!1,this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.secure=H.get(this.opts.connection.secure,!this.opts.connection.server&&!this.opts.connection.port),this.emotes="",this.emotesets={},this.channels=[],this.currentLatency=0,this.globaluserstate={},this.lastJoined="",this.latency=new Date,this.moderators={},this.pingLoop=null,this.pingTimeout=null,this.reason="",this.username="",this.userstate={},this.wasCloseCalled=!1,this.ws=null;var t="error";this.opts.options.debug&&(t="info"),this.log=this.opts.logger||o;try{o.setLevel(t)}catch(e){}this.opts.channels.forEach(function(e,t,s){s[t]=H.channel(e)}),i.call(this),this.setMaxListeners(0)}var e,t=c("./api"),n=c("./commands"),i=c("./events").EventEmitter,o=c("./logger"),q=c("./parser"),G=c("./timer"),r=(void 0!==a?a:"undefined"!=typeof window?window:{}).WebSocket||c("ws"),H=c("./utils");for(e in H.inherits(s,i),s.prototype.emits=function(e,t){for(var s=0;s<e.length;s++){var n=s<t.length?t[s]:t[t.length-1];this.emit.apply(this,[e[s]].concat(n))}},s.prototype.off=s.prototype.removeListener,s.prototype.api=t,n)s.prototype[e]=n[e];s.prototype.handleMessage=function(t){var s=this;if(!H.isNull(t)){this.listenerCount("raw_message")&&this.emit("raw_message",JSON.parse(JSON.stringify(t)),t);var e,n,i,o,r,a,c,u,l=H.channel(H.get(t.params[0],null)),m=H.get(t.params[1],null),h=H.get(t.tags["msg-id"],null),f=t.tags=q.badges(q.badgeInfo(q.emotes(t.tags)));for(e in f)"emote-sets"!==e&&"ban-duration"!==e&&"bits"!==e&&(n=f[e],H.isBoolean(n)?n=null:"1"===n?n=!0:"0"===n?n=!1:H.isString(n)&&(n=H.unescapeIRC(n)),f[e]=n);if(H.isNull(t.prefix))switch(t.command){case"PING":this.emit("ping"),this._isConnected()&&this.ws.send("PONG");break;case"PONG":var p=new Date;this.currentLatency=(p.getTime()-this.latency.getTime())/1e3,this.emits(["pong","_promisePing"],[[this.currentLatency]]),clearTimeout(this.pingTimeout);break;default:this.log.warn("Could not parse message with no prefix:\n"+JSON.stringify(t,null,4))}else if("tmi.twitch.tv"===t.prefix)switch(t.command){case"002":case"003":case"004":case"375":case"376":case"CAP":break;case"001":this.username=t.params[0];break;case"372":this.log.info("Connected to server."),this.userstate[this._globalDefaultChannel]={},this.emits(["connected","_promiseConnect"],[[this.server,this.port],[null]]),this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.pingLoop=setInterval(function(){s._isConnected()&&s.ws.send("PING"),s.latency=new Date,s.pingTimeout=setTimeout(function(){H.isNull(s.ws)||(s.wasCloseCalled=!1,s.log.error("Ping timeout."),s.ws.close(),clearInterval(s.pingLoop),clearTimeout(s.pingTimeout))},H.get(s.opts.connection.timeout,9999))},6e4);var d=H.get(this.opts.options.joinInterval,2e3);d<300&&(d=300);var g=new G.queue(d),_=H.union(this.opts.channels,this.channels);this.channels=[];for(var b=0;b<_.length;b++)!function(){var e=_[b];g.add(function(){s._isConnected()&&s.join(e).catch(function(e){return s.log.error(e)})})}();g.run();break;case"NOTICE":var y=[null],v=[l,h,m],w=[l,!0],C=[l,!1],k=[v,y],T=[v,[h]],x="["+l+"] "+m;switch(h){case"subs_on":this.log.info("["+l+"] This room is now in subscribers-only mode."),this.emits(["subscriber","subscribers","_promiseSubscribers"],[w,w,y]);break;case"subs_off":this.log.info("["+l+"] This room is no longer in subscribers-only mode."),this.emits(["subscriber","subscribers","_promiseSubscribersoff"],[C,C,y]);break;case"emote_only_on":this.log.info("["+l+"] This room is now in emote-only mode."),this.emits(["emoteonly","_promiseEmoteonly"],[w,y]);break;case"emote_only_off":this.log.info("["+l+"] This room is no longer in emote-only mode."),this.emits(["emoteonly","_promiseEmoteonlyoff"],[C,y]);break;case"slow_on":case"slow_off":break;case"followers_on_zero":case"followers_on":case"followers_off":break;case"r9k_on":this.log.info("["+l+"] This room is now in r9k mode."),this.emits(["r9kmode","r9kbeta","_promiseR9kbeta"],[w,w,y]);break;case"r9k_off":this.log.info("["+l+"] This room is no longer in r9k mode."),this.emits(["r9kmode","r9kbeta","_promiseR9kbetaoff"],[C,C,y]);break;case"room_mods":var S=m.split(": ")[1].toLowerCase().split(", ").filter(function(e){return e});this.emits(["_promiseMods","mods"],[[null,S],[l,S]]);break;case"no_mods":this.emits(["_promiseMods","mods"],[[null,[]],[l,[]]]);break;case"vips_success":m.endsWith(".")&&(m=m.slice(0,-1));var P=m.split(": ")[1].toLowerCase().split(", ").filter(function(e){return e});this.emits(["_promiseVips","vips"],[[null,P],[l,P]]);break;case"no_vips":this.emits(["_promiseVips","vips"],[[null,[]],[l,[]]]);break;case"already_banned":case"bad_ban_admin":case"bad_ban_broadcaster":case"bad_ban_global_mod":case"bad_ban_self":case"bad_ban_staff":case"usage_ban":this.log.info(x),this.emits(["notice","_promiseBan"],T);break;case"ban_success":this.log.info(x),this.emits(["notice","_promiseBan"],k);break;case"usage_clear":this.log.info(x),this.emits(["notice","_promiseClear"],T);break;case"usage_mods":this.log.info(x),this.emits(["notice","_promiseMods"],[v,[h,[]]]);break;case"mod_success":this.log.info(x),this.emits(["notice","_promiseMod"],k);break;case"usage_vips":this.log.info(x),this.emits(["notice","_promiseVips"],[v,[h,[]]]);break;case"usage_vip":case"bad_vip_grantee_banned":case"bad_vip_grantee_already_vip":case"bad_vip_max_vips_reached":case"bad_vip_achievement_incomplete":this.log.info(x),this.emits(["notice","_promiseVip"],[v,[h,[]]]);break;case"vip_success":this.log.info(x),this.emits(["notice","_promiseVip"],k);break;case"usage_mod":case"bad_mod_banned":case"bad_mod_mod":this.log.info(x),this.emits(["notice","_promiseMod"],T);break;case"unmod_success":this.log.info(x),this.emits(["notice","_promiseUnmod"],k);break;case"unvip_success":this.log.info(x),this.emits(["notice","_promiseUnvip"],k);break;case"usage_unmod":case"bad_unmod_mod":this.log.info(x),this.emits(["notice","_promiseUnmod"],T);break;case"usage_unvip":case"bad_unvip_grantee_not_vip":this.log.info(x),this.emits(["notice","_promiseUnvip"],T);break;case"color_changed":this.log.info(x),this.emits(["notice","_promiseColor"],k);break;case"usage_color":case"turbo_only_color":this.log.info(x),this.emits(["notice","_promiseColor"],T);break;case"commercial_success":this.log.info(x),this.emits(["notice","_promiseCommercial"],k);break;case"usage_commercial":case"bad_commercial_error":this.log.info(x),this.emits(["notice","_promiseCommercial"],T);break;case"hosts_remaining":this.log.info(x);P=isNaN(m[0])?0:parseInt(m[0]);this.emits(["notice","_promiseHost"],[v,[null,~~P]]);break;case"bad_host_hosting":case"bad_host_rate_exceeded":case"bad_host_error":case"usage_host":this.log.info(x),this.emits(["notice","_promiseHost"],[v,[h,null]]);break;case"already_r9k_on":case"usage_r9k_on":this.log.info(x),this.emits(["notice","_promiseR9kbeta"],T);break;case"already_r9k_off":case"usage_r9k_off":this.log.info(x),this.emits(["notice","_promiseR9kbetaoff"],T);break;case"timeout_success":this.log.info(x),this.emits(["notice","_promiseTimeout"],k);break;case"delete_message_success":this.log.info("["+l+" "+m+"]"),this.emits(["notice","_promiseDeletemessage"],k);case"already_subs_off":case"usage_subs_off":this.log.info(x),this.emits(["notice","_promiseSubscribersoff"],T);break;case"already_subs_on":case"usage_subs_on":this.log.info(x),this.emits(["notice","_promiseSubscribers"],T);break;case"already_emote_only_off":case"usage_emote_only_off":this.log.info(x),this.emits(["notice","_promiseEmoteonlyoff"],T);break;case"already_emote_only_on":case"usage_emote_only_on":this.log.info(x),this.emits(["notice","_promiseEmoteonly"],T);break;case"usage_slow_on":this.log.info(x),this.emits(["notice","_promiseSlow"],T);break;case"usage_slow_off":this.log.info(x),this.emits(["notice","_promiseSlowoff"],T);break;case"usage_timeout":case"bad_timeout_admin":case"bad_timeout_broadcaster":case"bad_timeout_duration":case"bad_timeout_global_mod":case"bad_timeout_self":case"bad_timeout_staff":this.log.info(x),this.emits(["notice","_promiseTimeout"],T);break;case"untimeout_success":case"unban_success":this.log.info(x),this.emits(["notice","_promiseUnban"],k);break;case"usage_unban":case"bad_unban_no_ban":this.log.info(x),this.emits(["notice","_promiseUnban"],T);break;case"usage_delete":case"bad_delete_message_error":case"bad_delete_message_broadcaster":case"bad_delete_message_mod":this.log.info(x),this.emits(["notice","_promiseDeletemessage"],T);break;case"usage_unhost":case"not_hosting":this.log.info(x),this.emits(["notice","_promiseUnhost"],T);break;case"whisper_invalid_login":case"whisper_invalid_self":case"whisper_limit_per_min":case"whisper_limit_per_sec":case"whisper_restricted":case"whisper_restricted_recipient":this.log.info(x),this.emits(["notice","_promiseWhisper"],T);break;case"no_permission":case"msg_banned":case"msg_room_not_found":case"msg_channel_suspended":case"tos_ban":case"invalid_user":this.log.info(x),this.emits(["notice","_promiseBan","_promiseClear","_promiseUnban","_promiseTimeout","_promiseDeletemessage","_promiseMods","_promiseMod","_promiseUnmod","_promiseVips","_promiseVip","_promiseUnvip","_promiseCommercial","_promiseHost","_promiseUnhost","_promiseJoin","_promisePart","_promiseR9kbeta","_promiseR9kbetaoff","_promiseSlow","_promiseSlowoff","_promiseFollowers","_promiseFollowersoff","_promiseSubscribers","_promiseSubscribersoff","_promiseEmoteonly","_promiseEmoteonlyoff","_promiseWhisper"],[v,[h,l]]);break;case"msg_rejected":case"msg_rejected_mandatory":this.log.info(x),this.emit("automod",l,h,m);break;case"unrecognized_cmd":this.log.info(x),this.emit("notice",l,h,m);break;case"cmds_available":case"host_target_went_offline":case"msg_censored_broadcaster":case"msg_duplicate":case"msg_emoteonly":case"msg_verified_email":case"msg_ratelimit":case"msg_subsonly":case"msg_timedout":case"msg_bad_characters":case"msg_channel_blocked":case"msg_facebook":case"msg_followersonly":case"msg_followersonly_followed":case"msg_followersonly_zero":case"msg_slowmode":case"msg_suspended":case"no_help":case"usage_disconnect":case"usage_help":case"usage_me":case"unavailable_command":this.log.info(x),this.emit("notice",l,h,m);break;case"host_on":case"host_off":break;default:m.includes("Login unsuccessful")||m.includes("Login authentication failed")||m.includes("Error logging in")||m.includes("Improperly formatted auth")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason=m,this.log.error(this.reason),this.ws.close()):m.includes("Invalid NICK")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason="Invalid NICK.",this.log.error(this.reason),this.ws.close()):(this.log.warn("Could not parse NOTICE from tmi.twitch.tv:\n"+JSON.stringify(t,null,4)),this.emit("notice",l,h,m))}break;case"USERNOTICE":var E=f["display-name"]||f.login,d=f["msg-param-sub-plan"]||"",L=H.unescapeIRC(H.get(f["msg-param-sub-plan-name"],""))||null,N={prime:d.includes("Prime"),plan:d,planName:L},D=~~(f["msg-param-streak-months"]||0),O=f["msg-param-recipient-display-name"]||f["msg-param-recipient-user-name"],I=~~f["msg-param-mass-gift-count"];switch(f["message-type"]=h){case"resub":this.emits(["resub","subanniversary"],[[l,E,D,m,f,N]]);break;case"sub":this.emit("subscription",l,E,N,m,f);break;case"subgift":this.emit("subgift",l,E,D,O,N,f);break;case"anonsubgift":this.emit("anonsubgift",l,D,O,N,f);break;case"submysterygift":this.emit("submysterygift",l,E,I,N,f);break;case"anonsubmysterygift":this.emit("anonsubmysterygift",l,I,N,f);break;case"primepaidupgrade":this.emit("primepaidupgrade",l,E,N,f);break;case"giftpaidupgrade":var R=f["msg-param-sender-name"]||f["msg-param-sender-login"];this.emit("giftpaidupgrade",l,E,R,f);break;case"anongiftpaidupgrade":this.emit("anongiftpaidupgrade",l,E,f);break;case"raid":var E=f["msg-param-displayName"]||f["msg-param-login"],A=+f["msg-param-viewerCount"];this.emit("raided",l,E,A,f);break;case"ritual":R=f["msg-param-ritual-name"];"new_chatter"===R?this.emit("newchatter",l,E,f,m):this.emit("ritual",R,l,E,f,m);break;default:this.emit("usernotice",h,l,f,m)}break;case"HOSTTARGET":L=m.split(" "),A=~~L[1]||0;"-"===L[0]?(this.log.info("["+l+"] Exited host mode."),this.emits(["unhost","_promiseUnhost"],[[l,A],[null]])):(this.log.info("["+l+"] Now hosting "+L[0]+" for "+A+" viewer(s)."),this.emit("hosting",l,L[0],A));break;case"CLEARCHAT":1<t.params.length?(i=H.get(t.tags["ban-duration"],null),H.isNull(i)?(this.log.info("["+l+"] "+m+" has been banned."),this.emit("ban",l,m,null,t.tags)):(this.log.info("["+l+"] "+m+" has been timed out for "+i+" seconds."),this.emit("timeout",l,m,null,~~i,t.tags))):(this.log.info("["+l+"] Chat was cleared by a moderator."),this.emits(["clearchat","_promiseClear"],[[l],[null]]));break;case"CLEARMSG":1<t.params.length&&(i=m,E=f.login,f["message-type"]="messagedeleted",this.log.info("["+l+"] "+E+"'s message has been deleted."),this.emit("messagedeleted",l,E,i,f));break;case"RECONNECT":this.log.info("Received RECONNECT request from Twitch.."),this.log.info("Disconnecting and reconnecting in "+Math.round(this.reconnectTimer/1e3)+" seconds.."),this.disconnect().catch(function(e){return s.log.error(e)}),setTimeout(function(){return s.connect().catch(function(e){return s.log.error(e)})},this.reconnectTimer);break;case"USERSTATE":t.tags.username=this.username,"mod"===t.tags["user-type"]&&(this.moderators[l]||(this.moderators[l]=[]),this.moderators[l].includes(this.username)||this.moderators[l].push(this.username)),H.isJustinfan(this.getUsername())||this.userstate[l]||(this.userstate[l]=f,this.lastJoined=l,this.channels.push(l),this.log.info("Joined "+l),this.emit("join",l,H.username(this.getUsername()),!0)),this.userstate[l]=f;break;case"GLOBALUSERSTATE":this.globaluserstate=f,t.tags["emote-sets"];break;case"ROOMSTATE":H.channel(this.lastJoined)===l&&this.emit("_promiseJoin",null,l),t.tags.channel=l,this.emit("roomstate",l,t.tags),t.tags.hasOwnProperty("subs-only")||(t.tags.hasOwnProperty("slow")&&("boolean"!=typeof t.tags.slow||t.tags.slow?(r=[l,!0,~~t.tags.slow],this.log.info("["+l+"] This room is now in slow mode."),this.emits(["slow","slowmode","_promiseSlow"],[r,r,[null]])):(o=[l,!1,0],this.log.info("["+l+"] This room is no longer in slow mode."),this.emits(["slow","slowmode","_promiseSlowoff"],[o,o,[null]]))),t.tags.hasOwnProperty("followers-only")&&("-1"===t.tags["followers-only"]?(o=[l,!1,0],this.log.info("["+l+"] This room is no longer in followers-only mode."),this.emits(["followersonly","followersmode","_promiseFollowersoff"],[o,o,[null]])):(r=[l,!0,~~t.tags["followers-only"]],this.log.info("["+l+"] This room is now in follower-only mode."),this.emits(["followersonly","followersmode","_promiseFollowers"],[r,r,[null]]))));break;case"SERVERCHANGE":break;default:this.log.warn("Could not parse message from tmi.twitch.tv:\n"+JSON.stringify(t,null,4))}else if("jtv"===t.prefix)"MODE"===t.command?"+o"===m?(this.moderators[l]||(this.moderators[l]=[]),this.moderators[l].includes(t.params[2])||this.moderators[l].push(t.params[2]),this.emit("mod",l,t.params[2])):"-o"===m&&(this.moderators[l]||(this.moderators[l]=[]),this.moderators[l].filter(function(e){return e!=t.params[2]}),this.emit("unmod",l,t.params[2])):this.log.warn("Could not parse message from jtv:\n"+JSON.stringify(t,null,4));else switch(t.command){case"353":this.emit("names",t.params[2],t.params[3].split(" "));break;case"366":break;case"JOIN":var M=t.prefix.split("!")[0];H.isJustinfan(this.getUsername())&&this.username===M&&(this.lastJoined=l,this.channels.push(l),this.log.info("Joined "+l),this.emit("join",l,M,!0)),this.username!==M&&this.emit("join",l,M,!1);break;case"PART":var U,j=!1,M=t.prefix.split("!")[0];this.username===M&&(j=!0,this.userstate[l]&&delete this.userstate[l],-1!==(U=this.channels.indexOf(l))&&this.channels.splice(U,1),-1!==(U=this.opts.channels.indexOf(l))&&this.opts.channels.splice(U,1),this.log.info("Left "+l),this.emit("_promisePart",null)),this.emit("part",l,M,j);break;case"WHISPER":M=t.prefix.split("!")[0];this.log.info("[WHISPER] <"+M+">: "+m),t.tags.hasOwnProperty("username")||(t.tags.username=M),t.tags["message-type"]="whisper";var J=H.channel(t.tags.username);this.emits(["whisper","message"],[[J,t.tags,m,!1]]);break;case"PRIVMSG":t.tags.username=t.prefix.split("!")[0],"jtv"===t.tags.username?(a=H.username(m.split(" ")[0]),c=m.includes("auto"),m.includes("hosting you for")?(J=H.extractNumber(m),this.emit("hosted",l,a,J,c)):m.includes("hosting you")&&this.emit("hosted",l,a,0,c)):(a=H.get(this.opts.options.messagesLogLevel,"info"),c=H.actionMessage(m),t.tags["message-type"]=c?"action":"chat",m=c?c[1]:m,t.tags.hasOwnProperty("bits")?this.emit("cheer",l,t.tags,m):(t.tags.hasOwnProperty("msg-id")?"highlighted-message"!==t.tags["msg-id"]&&"skip-subs-mode-message"!==t.tags["msg-id"]||(u=t.tags["msg-id"],this.emit("redeem",l,t.tags.username,u,t.tags,m)):t.tags.hasOwnProperty("custom-reward-id")&&(u=t.tags["custom-reward-id"],this.emit("redeem",l,t.tags.username,u,t.tags,m)),c?(this.log[a]("["+l+"] *<"+t.tags.username+">: "+m),this.emits(["action","message"],[[l,t.tags,m,!1]])):(this.log[a]("["+l+"] <"+t.tags.username+">: "+m),this.emits(["chat","message"],[[l,t.tags,m,!1]]))));break;default:this.log.warn("Could not parse message:\n"+JSON.stringify(t,null,4))}}},s.prototype.connect=function(){var n=this;return new Promise(function(t,s){n.server=H.get(n.opts.connection.server,"irc-ws.chat.twitch.tv"),n.port=H.get(n.opts.connection.port,80),n.secure&&(n.port=443),443===n.port&&(n.secure=!0),n.reconnectTimer=n.reconnectTimer*n.reconnectDecay,n.reconnectTimer>=n.maxReconnectInterval&&(n.reconnectTimer=n.maxReconnectInterval),n._openConnection(),n.once("_promiseConnect",function(e){e?s(e):t([n.server,~~n.port])})})},s.prototype._openConnection=function(){this.ws=new r((this.secure?"wss":"ws")+"://"+this.server+":"+this.port+"/","irc"),this.ws.onmessage=this._onMessage.bind(this),this.ws.onerror=this._onError.bind(this),this.ws.onclose=this._onClose.bind(this),this.ws.onopen=this._onOpen.bind(this)},s.prototype._onOpen=function(){var t=this;H.isNull(this.ws)||1!==this.ws.readyState||(this.log.info("Connecting to "+this.server+" on port "+this.port+".."),this.emit("connecting",this.server,~~this.port),this.username=H.get(this.opts.identity.username,H.justinfan()),this._getToken().then(function(e){e=H.password(e);t.log.info("Sending authentication to server.."),t.emit("logon"),t.ws.send("CAP REQ :twitch.tv/tags twitch.tv/commands twitch.tv/membership"),e?t.ws.send("PASS "+e):H.isJustinfan(t.username)&&t.ws.send("PASS SCHMOOPIIE"),t.ws.send("NICK "+t.username)}).catch(function(e){t.emits(["_promiseConnect","disconnected"],[[e],["Could not get a token."]])}))},s.prototype._getToken=function(){var e,t=this.opts.identity.password;return"function"==typeof t?(e=t())instanceof Promise?e:Promise.resolve(e):Promise.resolve(t)},s.prototype._onMessage=function(e){var t=this;e.data.split("\r\n").forEach(function(e){H.isNull(e)||t.handleMessage(q.msg(e))})},s.prototype._onError=function(){var t=this;this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),this.reason=H.isNull(this.ws)?"Connection closed.":"Unable to connect.",this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error("Reconnecting in "+Math.round(this.reconnectTimer/1e3)+" seconds.."),this.emit("reconnect"),setTimeout(function(){t.reconnecting=!1,t.connect().catch(function(e){return t.log.error(e)})},this.reconnectTimer)),this.ws=null},s.prototype._onClose=function(){var t=this;this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),this.wasCloseCalled?(this.wasCloseCalled=!1,this.reason="Connection closed.",this.log.info(this.reason),this.emits(["_promiseConnect","_promiseDisconnect","disconnected"],[[this.reason],[null],[this.reason]])):(this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error("Could not connect to server. Reconnecting in "+Math.round(this.reconnectTimer/1e3)+" seconds.."),this.emit("reconnect"),setTimeout(function(){t.reconnecting=!1,t.connect().catch(function(e){return t.log.error(e)})},this.reconnectTimer))),this.ws=null},s.prototype._getPromiseDelay=function(){return this.currentLatency<=600?600:this.currentLatency+100},s.prototype._sendCommand=function(n,i,o,r){var a=this;return new Promise(function(e,t){if(H.isNull(a.ws)||1!==a.ws.readyState)return t("Not connected to server.");var s;"number"==typeof n&&H.promiseDelay(n).then(function(){return t("No response from Twitch.")}),H.isNull(i)?(a.log.info("Executing command: "+o),a.ws.send(o)):(s=H.channel(i),a.log.info("["+s+"] Executing command: "+o),a.ws.send("PRIVMSG "+s+" :"+o)),"function"==typeof r?r(e,t):e()})},s.prototype._sendMessage=function(c,u,l,m){var h=this;return new Promise(function(e,t){if(H.isNull(h.ws)||1!==h.ws.readyState)return t("Not connected to server.");if(H.isJustinfan(h.getUsername()))return t("Cannot send anonymous messages.");var s,n=H.channel(u);h.userstate[n]||(h.userstate[n]={}),500<=l.length&&(s=H.splitLine(l,500),l=s[0],setTimeout(function(){h._sendMessage(c,u,s[1],function(){})},350)),h.ws.send("PRIVMSG "+n+" :"+l);var i={};Object.keys(h.emotesets).forEach(function(e){return h.emotesets[e].forEach(function(e){return(H.isRegex(e.code)?q.emoteRegex:q.emoteString)(l,e.code,e.id,i)})});var o=H.merge(h.userstate[n],q.emotes({emotes:q.transformEmotes(i)||null})),r=H.get(h.opts.options.messagesLogLevel,"info"),a=H.actionMessage(l);a?(o["message-type"]="action",h.log[r]("["+n+"] *<"+h.getUsername()+">: "+a[1]),h.emits(["action","message"],[[n,o,a[1],!0]])):(o["message-type"]="chat",h.log[r]("["+n+"] <"+h.getUsername()+">: "+l),h.emits(["chat","message"],[[n,o,l,!0]])),"function"==typeof m?m(e,t):e()})},s.prototype._updateEmoteset=function(n){var i=this;this.emotes=n,this._getToken().then(function(e){return i.api({url:"/chat/emoticon_images?emotesets="+n,headers:{Authorization:"OAuth "+H.token(e),"Client-ID":i.clientId}},function(e,t,s){return e?void setTimeout(function(){return i._updateEmoteset(n)},6e4):(i.emotesets=s.emoticon_sets||{},i.emit("emotesets",n,i.emotesets))})}).catch(function(){return setTimeout(function(){return i._updateEmoteset(n)},6e4)})},s.prototype.getUsername=function(){return this.username},s.prototype.getOptions=function(){return this.opts},s.prototype.getChannels=function(){return this.channels},s.prototype.isMod=function(e,t){e=H.channel(e);return this.moderators[e]||(this.moderators[e]=[]),this.moderators[e].includes(H.username(t))},s.prototype.readyState=function(){return H.isNull(this.ws)?"CLOSED":["CONNECTING","OPEN","CLOSING","CLOSED"][this.ws.readyState]},s.prototype._isConnected=function(){return null!==this.ws&&1===this.ws.readyState},s.prototype.disconnect=function(){var s=this;return new Promise(function(e,t){H.isNull(s.ws)||3===s.ws.readyState?(s.log.error("Cannot disconnect from server. Socket is not opened or connection is already closing."),t("Cannot disconnect from server. Socket is not opened or connection is already closing.")):(s.wasCloseCalled=!0,s.log.info("Disconnecting from server.."),s.ws.close(),s.once("_promiseDisconnect",function(){return e([s.server,~~s.port])}))})},void 0!==u&&u.exports&&(u.exports=s),"undefined"!=typeof window&&(window.tmi={},window.tmi.client=s,window.tmi.Client=s)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./api":1,"./commands":3,"./events":4,"./logger":6,"./parser":7,"./timer":8,"./utils":9,ws:10}],3:[function(e,t,s){"use strict";var u=e("./utils");function n(n,i){var e=this;return n=u.channel(n),i=u.get(i,30),this._sendCommand(this._getPromiseDelay(),n,"/followers "+i,function(t,s){e.once("_promiseFollowers",function(e){e?s(e):t([n,~~i])})})}function i(n){var e=this;return n=u.channel(n),this._sendCommand(this._getPromiseDelay(),n,"/followersoff",function(t,s){e.once("_promiseFollowersoff",function(e){e?s(e):t([n])})})}function o(n){var e=this;return n=u.channel(n),this._sendCommand(this._getPromiseDelay(),null,"PART "+n,function(t,s){e.once("_promisePart",function(e){e?s(e):t([n])})})}function r(n){var e=this;return n=u.channel(n),this._sendCommand(this._getPromiseDelay(),n,"/r9kbeta",function(t,s){e.once("_promiseR9kbeta",function(e){e?s(e):t([n])})})}function a(n){var e=this;return n=u.channel(n),this._sendCommand(this._getPromiseDelay(),n,"/r9kbetaoff",function(t,s){e.once("_promiseR9kbetaoff",function(e){e?s(e):t([n])})})}function c(n,i){var e=this;return n=u.channel(n),i=u.get(i,300),this._sendCommand(this._getPromiseDelay(),n,"/slow "+i,function(t,s){e.once("_promiseSlow",function(e){e?s(e):t([n,~~i])})})}function l(n){var e=this;return n=u.channel(n),this._sendCommand(this._getPromiseDelay(),n,"/slowoff",function(t,s){e.once("_promiseSlowoff",function(e){e?s(e):t([n])})})}t.exports={action:function(s,n){return s=u.channel(s),n="ACTION "+n+"",this._sendMessage(this._getPromiseDelay(),s,n,function(e,t){e([s,n])})},ban:function(n,i,o){var e=this;return n=u.channel(n),i=u.username(i),o=u.get(o,""),this._sendCommand(this._getPromiseDelay(),n,"/ban "+i+" "+o,function(t,s){e.once("_promiseBan",function(e){e?s(e):t([n,i,o])})})},clear:function(n){var e=this;return n=u.channel(n),this._sendCommand(this._getPromiseDelay(),n,"/clear",function(t,s){e.once("_promiseClear",function(e){e?s(e):t([n])})})},color:function(e,n){var i=this;return n=u.get(n,e),this._sendCommand(this._getPromiseDelay(),"#tmijs","/color "+n,function(t,s){i.once("_promiseColor",function(e){e?s(e):t([n])})})},commercial:function(n,i){var e=this;return n=u.channel(n),i=u.get(i,30),this._sendCommand(this._getPromiseDelay(),n,"/commercial "+i,function(t,s){e.once("_promiseCommercial",function(e){e?s(e):t([n,~~i])})})},deletemessage:function(n,e){var i=this;return n=u.channel(n),this._sendCommand(this._getPromiseDelay(),n,"/delete "+e,function(t,s){i.once("_promiseDeletemessage",function(e){e?s(e):t([n])})})},emoteonly:function(n){var e=this;return n=u.channel(n),this._sendCommand(this._getPromiseDelay(),n,"/emoteonly",function(t,s){e.once("_promiseEmoteonly",function(e){e?s(e):t([n])})})},emoteonlyoff:function(n){var e=this;return n=u.channel(n),this._sendCommand(this._getPromiseDelay(),n,"/emoteonlyoff",function(t,s){e.once("_promiseEmoteonlyoff",function(e){e?s(e):t([n])})})},followersonly:n,followersmode:n,followersonlyoff:i,followersmodeoff:i,host:function(i,o){var e=this;return i=u.channel(i),o=u.username(o),this._sendCommand(2e3,i,"/host "+o,function(s,n){e.once("_promiseHost",function(e,t){e?n(e):s([i,o,~~t])})})},join:function(a){var c=this;return a=u.channel(a),this._sendCommand(null,null,"JOIN "+a,function(n,i){var o="_promiseJoin",r=!1,e=function e(t,s){a===u.channel(s)&&(c.removeListener(o,e),r=!0,t?i(t):n([a]))};c.on(o,e);e=c._getPromiseDelay();u.promiseDelay(e).then(function(){r||c.emit(o,"No response from Twitch.",a)})})},mod:function(n,i){var e=this;return n=u.channel(n),i=u.username(i),this._sendCommand(this._getPromiseDelay(),n,"/mod "+i,function(t,s){e.once("_promiseMod",function(e){e?s(e):t([n,i])})})},mods:function(i){var o=this;return i=u.channel(i),this._sendCommand(this._getPromiseDelay(),i,"/mods",function(s,n){o.once("_promiseMods",function(e,t){e?n(e):(t.forEach(function(e){o.moderators[i]||(o.moderators[i]=[]),o.moderators[i].includes(e)||o.moderators[i].push(e)}),s(t))})})},part:o,leave:o,ping:function(){var s=this;return this._sendCommand(this._getPromiseDelay(),null,"PING",function(t,e){s.latency=new Date,s.pingTimeout=setTimeout(function(){null!==s.ws&&(s.wasCloseCalled=!1,s.log.error("Ping timeout."),s.ws.close(),clearInterval(s.pingLoop),clearTimeout(s.pingTimeout))},u.get(s.opts.connection.timeout,9999)),s.once("_promisePing",function(e){return t([parseFloat(e)])})})},r9kbeta:r,r9kmode:r,r9kbetaoff:a,r9kmodeoff:a,raw:function(s){return this._sendCommand(this._getPromiseDelay(),null,s,function(e,t){e([s])})},say:function(s,n){return s=u.channel(s),n.startsWith(".")&&!n.startsWith("..")||n.startsWith("/")||n.startsWith("\\")?"me "===n.substr(1,3)?this.action(s,n.substr(4)):this._sendCommand(this._getPromiseDelay(),s,n,function(e,t){e([s,n])}):this._sendMessage(this._getPromiseDelay(),s,n,function(e,t){e([s,n])})},slow:c,slowmode:c,slowoff:l,slowmodeoff:l,subscribers:function(n){var e=this;return n=u.channel(n),this._sendCommand(this._getPromiseDelay(),n,"/subscribers",function(t,s){e.once("_promiseSubscribers",function(e){e?s(e):t([n])})})},subscribersoff:function(n){var e=this;return n=u.channel(n),this._sendCommand(this._getPromiseDelay(),n,"/subscribersoff",function(t,s){e.once("_promiseSubscribersoff",function(e){e?s(e):t([n])})})},timeout:function(n,i,o,r){var e=this;return n=u.channel(n),i=u.username(i),u.isNull(o)||u.isInteger(o)||(r=o,o=300),o=u.get(o,300),r=u.get(r,""),this._sendCommand(this._getPromiseDelay(),n,"/timeout "+i+" "+o+" "+r,function(t,s){e.once("_promiseTimeout",function(e){e?s(e):t([n,i,~~o,r])})})},unban:function(n,i){var e=this;return n=u.channel(n),i=u.username(i),this._sendCommand(this._getPromiseDelay(),n,"/unban "+i,function(t,s){e.once("_promiseUnban",function(e){e?s(e):t([n,i])})})},unhost:function(n){var e=this;return n=u.channel(n),this._sendCommand(2e3,n,"/unhost",function(t,s){e.once("_promiseUnhost",function(e){e?s(e):t([n])})})},unmod:function(n,i){var e=this;return n=u.channel(n),i=u.username(i),this._sendCommand(this._getPromiseDelay(),n,"/unmod "+i,function(t,s){e.once("_promiseUnmod",function(e){e?s(e):t([n,i])})})},unvip:function(n,i){var e=this;return n=u.channel(n),i=u.username(i),this._sendCommand(this._getPromiseDelay(),n,"/unvip "+i,function(t,s){e.once("_promiseUnvip",function(e){e?s(e):t([n,i])})})},vip:function(n,i){var e=this;return n=u.channel(n),i=u.username(i),this._sendCommand(this._getPromiseDelay(),n,"/vip "+i,function(t,s){e.once("_promiseVip",function(e){e?s(e):t([n,i])})})},vips:function(e){var t=this;return e=u.channel(e),this._sendCommand(this._getPromiseDelay(),e,"/vips",function(s,n){t.once("_promiseVips",function(e,t){e?n(e):s(t)})})},whisper:function(s,n){var i=this;return(s=u.username(s))===this.getUsername()?Promise.reject("Cannot send a whisper to the same account."):this._sendCommand(this._getPromiseDelay(),"#tmijs","/w "+s+" "+n,function(e,t){i.once("_promiseWhisper",function(e){e&&t(e)})}).catch(function(e){if(e&&"string"==typeof e&&0!==e.indexOf("No response from Twitch."))throw e;var t=u.channel(s),e=u.merge({"message-type":"whisper","message-id":null,"thread-id":null,username:i.getUsername()},i.globaluserstate);return i.emits(["whisper","message"],[[t,e,n,!0],[t,e,n,!0]]),[s,n]})}}},{"./utils":9}],4:[function(e,t,s){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)};function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function c(e){return"function"==typeof e}function u(e){return"object"===(void 0===e?"undefined":i(e))&&null!==e}function a(e){return void 0===e}((t.exports=o).EventEmitter=o).prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},o.prototype.emit=function(e){var t,s,n,i,o,r;if(this._events||(this._events={}),"error"===e&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(a(s=this._events[e]))return!1;if(c(s))switch(arguments.length){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),s.apply(this,i)}else if(u(s))for(i=Array.prototype.slice.call(arguments,1),n=(r=s.slice()).length,o=0;o<n;o++)r[o].apply(this,i);return!0},o.prototype.on=o.prototype.addListener=function(e,t){var s;if(!c(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,c(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned&&(s=a(this._maxListeners)?o.defaultMaxListeners:this._maxListeners)&&0<s&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},o.prototype.once=function(e,t){if(!c(t))throw TypeError("listener must be a function");var s=!1;if(this._events.hasOwnProperty(e)&&"_"===e.charAt(0)){var n,i=1,o=e;for(n in this._events)this._events.hasOwnProperty(n)&&n.startsWith(o)&&i++;e+=i}function r(){"_"!==e.charAt(0)||isNaN(e.substr(e.length-1))||(e=e.substring(0,e.length-1)),this.removeListener(e,r),s||(s=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},o.prototype.removeListener=function(e,t){var s,n,i,o;if(!c(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=(s=this._events[e]).length,n=-1,s===t||c(s.listener)&&s.listener===t){if(delete this._events[e],this._events.hasOwnProperty(e+"2")&&"_"===e.charAt(0)){var r,a=e;for(r in this._events)this._events.hasOwnProperty(r)&&r.startsWith(a)&&(isNaN(parseInt(r.substr(r.length-1)))||(this._events[e+parseInt(r.substr(r.length-1)-1)]=this._events[r],delete this._events[r]));this._events[e]=this._events[e+"1"],delete this._events[e+"1"]}this._events.removeListener&&this.emit("removeListener",e,t)}else if(u(s)){for(o=i;0<o--;)if(s[o]===t||s[o].listener&&s[o].listener===t){n=o;break}if(n<0)return this;1===s.length?(s.length=0,delete this._events[e]):s.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},o.prototype.removeAllListeners=function(e){var t,s;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(c(s=this._events[e]))this.removeListener(e,s);else if(s)for(;s.length;)this.removeListener(e,s[s.length-1]);return delete this._events[e],this},o.prototype.listeners=function(e){e=this._events&&this._events[e]?c(this._events[e])?[this._events[e]]:this._events[e].slice():[];return e},o.prototype.listenerCount=function(e){if(this._events){e=this._events[e];if(c(e))return 1;if(e)return e.length}return 0},o.listenerCount=function(e,t){return e.listenerCount(t)}},{}],5:[function(e,t,s){"use strict";t.exports={client:e("../lib/client"),Client:e("../lib/client")}},{"../lib/client":2}],6:[function(e,t,s){"use strict";var n=e("./utils"),i="info",o={trace:0,debug:1,info:2,warn:3,error:4,fatal:5};function r(t){return function(e){o[i]<=o[t]&&console.log("["+n.formatDate(new Date)+"] "+t+": "+e)}}t.exports={setLevel:function(e){i=e},trace:r("trace"),debug:r("debug"),info:r("info"),warn:r("warn"),error:r("error"),fatal:r("fatal")}},{"./utils":9}],7:[function(e,t,s){"use strict";var m=e("./utils"),r=/\S+/g;function n(e,t,s,n,i){var s=2<arguments.length&&void 0!==s?s:",",o=3<arguments.length&&void 0!==n?n:"/",r=i,n=e[t];if(void 0===n)return e;i=m.isString(n);if(e[t+"-raw"]=i?n:null,!0===n)return e[t]=null,e;if(e[t]={},i)for(var a=n.split(s),c=0;c<a.length;c++){var u=a[c].split(o),l=u[1];void 0!==r&&l&&(l=l.split(r)),e[t][u[0]]=l||null}return e}t.exports={badges:function(e){return n(e,"badges")},badgeInfo:function(e){return n(e,"badge-info")},emotes:function(e){return n(e,"emotes","/",":",",")},emoteRegex:function(e,t,s,n){r.lastIndex=0;for(var i,o=new RegExp("(\\b|^|s)"+m.unescapeHtml(t)+"(\\b|$|s)");null!==(i=r.exec(e));)o.test(i[0])&&(n[s]=n[s]||[],n[s].push([i.index,r.lastIndex-1]))},emoteString:function(e,t,s,n){var i;for(r.lastIndex=0;null!==(i=r.exec(e));)i[0]===m.unescapeHtml(t)&&(n[s]=n[s]||[],n[s].push([i.index,r.lastIndex-1]))},transformEmotes:function(t){var s="";return Object.keys(t).forEach(function(e){s=s+e+":",t[e].forEach(function(e){return s=s+e.join("-")+","}),s=s.slice(0,-1)+"/"}),s.slice(0,-1)},formTags:function(e){var t,s=[];for(t in e){var n=m.escapeIRC(e[t]);s.push(t+"="+n)}return"@"+s.join(";")},msg:function(e){var t={raw:e,tags:{},prefix:null,command:null,params:[]},s=0,n=0;if(64===e.charCodeAt(0)){if(-1===(n=e.indexOf(" ")))return null;for(var i=e.slice(1,n).split(";"),o=0;o<i.length;o++){var r=i[o],a=r.split("=");t.tags[a[0]]=r.substring(r.indexOf("=")+1)||!0}s=n+1}for(;32===e.charCodeAt(s);)s++;if(58===e.charCodeAt(s)){if(-1===(n=e.indexOf(" ",s)))return null;for(t.prefix=e.slice(s+1,n),s=n+1;32===e.charCodeAt(s);)s++}if(-1===(n=e.indexOf(" ",s)))return e.length>s?(t.command=e.slice(s),t):null;for(t.command=e.slice(s,n),s=n+1;32===e.charCodeAt(s);)s++;for(;s<e.length;){if(n=e.indexOf(" ",s),58===e.charCodeAt(s)){t.params.push(e.slice(s+1));break}if(-1===n){if(-1===n){t.params.push(e.slice(s));break}}else for(t.params.push(e.slice(s,n)),s=n+1;32===e.charCodeAt(s);)s++}return t}}},{"./utils":9}],8:[function(e,t,s){"use strict";function n(e){this.queue=[],this.index=0,this.defaultDelay=e||3e3}n.prototype.add=function(e,t){this.queue.push({fn:e,delay:t})},n.prototype.run=function(e){!e&&0!==e||(this.index=e),this.next()},n.prototype.next=function(){var e=this,t=this.index++,t=this.queue[t],s=this.queue[this.index];t&&(t.fn(),s&&setTimeout(function(){e.next()},s.delay||this.defaultDelay))},n.prototype.reset=function(){this.index=0},n.prototype.clear=function(){this.index=0,this.queue=[]},s.queue=n},{}],9:[function(e,f,t){(function(h){(function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var e="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)};function s(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}var n,i=/^\u0001ACTION ([^\u0001]+)\u0001$/,o=/^(justinfan)(\d+$)/,r=/\\([sn:r\\])/g,a=/([ \n;\r\\])/g,c={s:" ",n:"",":":";",r:""},u={" ":"s","\n":"n",";":":","\r":"r"},l=f.exports={get:function(e,t){return void 0===e?t:e},isBoolean:function(e){return"boolean"==typeof e},isFinite:(n=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},m.toString=function(){return n.toString()},m),isInteger:function(e){return!isNaN(l.toNumber(e,0))},isJustinfan:function(e){return o.test(e)},isNull:function(e){return null===e},isRegex:function(e){return/[\|\\\^\$\*\+\?\:\#]/.test(e)},isString:function(e){return"string"==typeof e},isURL:function(e){return new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i").test(e)},justinfan:function(){return"justinfan"+Math.floor(8e4*Math.random()+1e3)},token:function(e){return e?e.toLowerCase().replace("oauth:",""):""},password:function(e){e=l.token(e);return e?"oauth:"+e:""},promiseDelay:function(t){return new Promise(function(e){return setTimeout(e,t)})},replaceAll:function(e,t){if(null==e)return null;for(var s in t)e=e.replace(new RegExp(s,"g"),t[s]);return e},unescapeHtml:function(e){return e.replace(/\\&amp\\;/g,"&").replace(/\\&lt\\;/g,"<").replace(/\\&gt\\;/g,">").replace(/\\&quot\\;/g,'"').replace(/\\&#039\\;/g,"'")},unescapeIRC:function(e){return e&&e.includes("\\")?e.replace(r,function(e,t){return t in c?c[t]:t}):e},escapeIRC:function(e){return e&&e.replace(a,function(e,t){return t in u?"\\"+u[t]:t})},actionMessage:function(e){return e.match(i)},addWord:function(e,t){return e.length?e+" "+t:e+t},channel:function(e){var t=(e||"").toLowerCase();return"#"===t[0]?t:"#"+t},extractNumber:function(e){for(var t=e.split(" "),s=0;s<t.length;s++)if(l.isInteger(t[s]))return~~t[s];return 0},formatDate:function(e){var t=e.getHours(),e=e.getMinutes();return(t=(t<10?"0":"")+t)+":"+(e=(e<10?"0":"")+e)},inherits:function(e,t){e.super_=t;function s(){}s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e},isNode:function(){try{return"object"===(void 0===h?"undefined":e(h))&&"[object process]"===Object.prototype.toString.call(h)}catch(e){}return!1},merge:Object.assign,splitLine:function(e,t){var s=e.substring(0,t).lastIndexOf(" ");return-1===s&&(s=t-1),[e.substring(0,s),e.substring(s+1)]},toNumber:function(e,t){if(null===e)return 0;t=Math.pow(10,l.isFinite(t)?t:0);return Math.round(e*t)/t},union:function(e,t){return[].concat(s(new Set([].concat(s(e),s(t)))))},username:function(e){var t=(e||"").toLowerCase();return"#"===t[0]?t.slice(1):t}};function m(e){return n.apply(this,arguments)}}).call(this)}).call(this,e("_process"))},{_process:11}],10:[function(e,t,s){},{}],11:[function(e,t,s){var n,i,t=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:r}catch(e){i=r}}();var c,u=[],l=!1,m=-1;function h(){l&&c&&(l=!1,c.length?u=c.concat(u):m=-1,u.length&&f())}function f(){if(!l){var e=a(h);l=!0;for(var t=u.length;t;){for(c=u,u=[];++m<t;)c&&c[m].run();m=-1,t=u.length}c=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===r||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function d(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];u.push(new p(e,t)),1!==u.length||l||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=d,t.addListener=d,t.once=d,t.off=d,t.removeListener=d,t.removeAllListeners=d,t.emit=d,t.prependListener=d,t.prependOnceListener=d,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}]},{},[5]);